(---
	"map.sll"
	"string.sll"
	"types.sll"
)



(= _lib_map <>)



(= clib_library_type (&:
	(,,, data
		(@@ (<- string$format (?: data$_handle
			"<%s @%#.16llx>"
			"<%s @(unloaded)>"
		) data$file_path data$_handle))
	) @@string@@
	(,,, data
		(? (! data$_handle) (@@ false))
		(<- map$remove _lib_map data$file_path)
		(<- (... "clib:unload_library") data$_handle)
	) @@delete@@
	(~ string_type) file_path
	(~ map_type) symbols
	int_type _handle
))



(## _lib_map clib_library_type)
