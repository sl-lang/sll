(--- "types.sll" "error.sll")



(= base64_module_type (&:
	(~ string_type) ALPHABET
	(~ string_type) ALPHABET_URL_SAFE
	(~ func_type) decode
	(~ func_type) encode
))



(= ALPHABET "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")
(= ALPHABET_URL_SAFE "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_")



(= decode (,,, dt
	(? (=== dt nil) (@@ nil))
	(= dt (:: dt string_type))
	(= o (<- (... "sll:base64_decode") dt))
	(@@ (?: (=== (:? o) int_type)
		(<- error$from_internal o <
			"string" dt
		>)
		o
	))
)

(= encode (... "sll:base64_encode"))



(= base64 (. base64_module_type
	ALPHABET
	ALPHABET_URL_SAFE
	decode
	encode
))
(## base64)
