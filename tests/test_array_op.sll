(--- "_common.sll")

(<- run "Array operators" (,,,
	; Access
	(<- expect (: [1 2 3 4] 0) 1 "Access")
	(<- expect (: [1 2 3 4] -1) 4 "Access from end")
	(<- expect (: [1 2 3 4] 4) 1 "Access out-of-bounds")
	(<- expect (: [1 2 3 4] -5) 4 "Access from end, out-of-bounds")
	; ; Access Range
	; (<- expect (: [1 2 3 4] 1 3) [2 3] "Access range")
	; (<- expect (: [1 2 3 4] 1 -1) [2 3] "Access range, index from end")
	; ; Access Range + Step
	; (<- expect (: [1 2 3 4] 0 3 2) [1 3] "Access range and step")
	; Add
	(<- expect (+ [1 2 3] 4) [1 2 3 4] "Add integer")
	(<- expect (+ [1 2 3] 4.1) [1 2 3 4.1] "Add float")
	(<- expect (+ [1 2 3] '4') [1 2 3 '4'] "Add char")
	(<- expect (+ [1 2 3] "4") [1 2 3 "4"] "Add string")
	(<- expect (+ [1 2 3] [4 5]) [1 2 3 4 5] "Add array")
	(<- expect (+ [1 2 3] <4 5>) [1 2 3 <4 5>] "Add map")
	; Bitwise AND / Intersection
	(<- expect (& [1 2 3] 2) [0 2 2] "Bitwise AND with integer")
	(<- expect (& [1 2.0 3] 2.0) [0.0 2.0 0.0] "Bitwise AND with float")
	(<- expect (& [1 2 3] '2') [0 2 2] "Bitwise AND with char")
	(<- expect (& [1 2 3] "\x01\x02\x00") [1 2 0] "Bitwise AND with string")
	(<- expect (& [1 2 3] [2 4 5]) [2] "Bitwise AND with array")
	(<- expect (& [1 2 3] <4 5 2 3>) <2 6> "Bitwise AND with map")
	; Assign
	(<- expect (,
		(= arr [1 2 3])
		(= (: arr 1) 'b')
		arr
	) [1 'b' 3] "Assign value")
	(<- expect (,
		(= arr [1 2 3])
		(= (: arr -3) 'a')
		arr
	) ['a' 2 3] "Assign value from end")
	(<- expect (,
		(= arr [1 2 3])
		(= (: arr 11) 'c')
		arr
	) [1 2 'c'] "Assign value out-of-bounds")
	; Assign Range
	|# TODO #|
	; Assign Range + Step
	|# TODO #|
	; Boolean / Truth value
	(<- expect (!! []) 0 "Truth value of empty array")
	(<- expect (!! [1]) 1 "Truth value of non-empty array")
	; Compare
	|# TODO #|
	; Decrement
	; (<- expect (-- [1 2 3]) [2 3] "Decrement array")
	; Element counting
	(<- expect (/ [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 1) 2 "Count integer (division)")
	(<- expect (/ [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 1.0) 0 "Count float (division)")
	(<- expect (/ [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 'a') 1 "Count char (division)")
	(<- expect (/ [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] "3") 2 "Count string (division)")
	(<- expect (/ [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] [1 2.0 'a']) 4 "Count multiple (division)")
	(<- expect (/ [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] [[3 1 4]]) 1 "Count array (division)")
	(<- expect (/ [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] <"A" 'a'>) 1 "Count map (division)")
	; Duplicate
	|# TODO #|
	; Equality
	(<- expect (== [1 2 3 4] 4) 1 "Equal to integer")
	(<- expect (== [1 2 3 4] 4.0) 1 "Equal to float")
	(<- expect (== [1 2 3 4] '\x04') 1 "Equal to char")
	(<- expect (== [1 2 3 4] "\x01\x02\x03\x04") 1 "Equal to string")
	(<- expect (== [1 2 3 4] [1 2 3 4]) 1 "Equal to array")
	(<- expect (== [1 2 3 4] <0 1 1 2 2 3 3 4>) 1 "Equal to map")
	; Element counting
	(<- expect (// [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 1) 2 "Count integer (floored division)")
	(<- expect (// [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 1.0) 0 "Count float (floored division)")
	(<- expect (// [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 'a') 1 "Count char (floored division)")
	(<- expect (// [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] "3") 2 "Count string (floored division)")
	(<- expect (// [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] [1 2.0 'a']) 4 "Count multiple (floored division)")
	(<- expect (// [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] [[3 1 4]]) 1 "Count array (floored division)")
	(<- expect (// [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] <"A" 'a'>) 1 "Count map (floored division)")
	; Increment
	; (<- expect (++ [1 2 3]) [1 2 3 1] "Increment array")
	; Membership test
	|# TODO #|
	; Element inversion
	(<- expect (~ [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>]) [-2 -3.0 "\xcc" -2 '\x9e' "\xcc" [-4 -2 -5] <"A" '\x9e'>] "Element inversion")
	; Length
	(<- expect ($ []) 0 "Length of empty array")
	(<- expect ($ [1 2 3 4 5]) 5 "Length of array")
	(<- expect ($ [[1 2 3]]) 1 "Length of nested array")
	; Element modulo
	|# TODO #|
	; Multiplication / Combinations
	|# TODO #|
	; Bitwise OR
	|# TODO #|
	; Left shift / Resize
	|# TODO #|
	; Right shift / Resize
	|# TODO #|
	; Strict equality
	(<- expect (=== [1 2 3 4] 4) 0 "Strict equal to integer")
	(<- expect (!== [1 2 3 4] 4) 1 "Strict not equal to integer")
	(<- expect (=== [1 2 3 4] 4.0) 0 "Strict equal to float")
	(<- expect (!== [1 2 3 4] 4.0) 1 "Strict not equal to float")
	(<- expect (=== [1 2 3 4] '\x04') 0 "Strict equal to char")
	(<- expect (!== [1 2 3 4] '\x04') 1 "Strict not equal to char")
	(<- expect (=== [1 2 3 4] "\x01\x02\x03\x04") 0 "Strict equal to string")
	(<- expect (!== [1 2 3 4] "\x01\x02\x03\x04") 1 "Strict not equal to string")
	(<- expect (=== [1 2 3 4] [1 2 3 4]) 1 "Strict equal to array")
	(<- expect (!== [1 2 3 4] [1 2 3 4]) 0 "Strict not equal to array")
	(<- expect (=== [1 2 3 4] <0 1 1 2 2 3 3 4>) 0 "Strict equal to map")
	(<- expect (!== [1 2 3 4] <0 1 1 2 2 3 3 4>) 1 "Strict not equal to map")
	; Subtraction / Element removing
	(<- expect (- [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 1) [2.0 "3" 'a' "3" [3 1 4] <"A" 'a'>] "Remove integer")
	(<- expect (- [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 1.0) [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] "Remove float")
	(<- expect (- [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] 'a') [1 2.0 "3" 1 "3" [3 1 4] <"A" 'a'>] "Remove char")
	(<- expect (- [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] "3") [1 2.0 1 'a' [3 1 4] <"A" 'a'>] "Remove string")
	(<- expect (- [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] [1 2.0 'a']) ["3" "3" [3 1 4] <"A" 'a'>] "Remove multiple")
	(<- expect (- [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] [[3 1 4]]) [1 2.0 "3" 1 'a' "3" <"A" 'a'>] "Remove array")
	(<- expect (- [1 2.0 "3" 1 'a' "3" [3 1 4] <"A" 'a'>] <"A" 'a'>) [1 2.0 "3" 1 'a' "3" [3 1 4]] "Remove map")
	; Bitwise Exclusive OR
	|# TODO #|
))
